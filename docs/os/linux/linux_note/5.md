<!-- TOC -->

- [linux 文件权限与目录配置](#linux-文件权限与目录配置)
    - [文件权限概念](#文件权限概念)
        - [linux 文件属性](#linux-文件属性)
        - [如何改变文件属性与权限](#如何改变文件属性与权限)
            - [`chgrp` 改变文件所属群组](#chgrp-改变文件所属群组)
            - [`chown` 改变文件拥有者](#chown-改变文件拥有者)
            - [`chmod` 改变文件的权限](#chmod-改变文件的权限)
    - [linux 目录配置](#linux-目录配置)
        - [linux 目录配置的依据 FHS](#linux-目录配置的依据-fhs)
            - [根目录 `/` 的意义与内容](#根目录--的意义与内容)
            - [`/usr` 的意义与内容](#usr-的意义与内容)
            - [`/var` 的意义与内容](#var-的意义与内容)
            - [目录树](#目录树)

<!-- /TOC -->

# linux 文件权限与目录配置

## 文件权限概念

### linux 文件属性

```shell
ls -al
# drwx------   3    root   root     4096   Sep  5 10:37 .gconf      <=范例说明处
# -rw-r--r--   1    root   root    42304   Sep  4 18:26 install.log <=范例说明处
# [     1   ][ 2 ][  3  ][  4  ][   5   ][     6     ][       7          ]
# [  权限  ][连结][ 拥有者 ][群组][文件大小][  修改日期 ][      文件名        ]
```

- 第一栏代表这个文件的类型与权限
  - 第一个字符
    - 当为 `d` 则是目录，例如上表文件名为 `.gconf` 的那一行
    - 当为 `-` 则是文件，例如上表文件名为 `install.log` 那一行
    - 若是 `l` 则表示为连结档（link file）
    - 若是 `b` 则表示为装置文件里面的可供储存的接口设备(可随机存取装置)
    - 若是 `c` 则表示为装置文件里面的串行端口设备，例如键盘、鼠标(一次性读取装置)
  - 权限字段
    - 所有者
    - 所属组
    - 其他人
- 第二栏代表有多少文件连接到此节点

### 如何改变文件属性与权限

#### `chgrp` 改变文件所属群组

```shell
chgrp [-R] dirname/filename ...
```

选项与参数：

- `-R` 进行递归(recursive)的持续变更，亦即连同次目录下的所有文件、目录都更新成为这个群组之意。常常用在变更某一目录内所有的文件之情况。

```shell
chgrp users install.log
ls -l
# -rw-r--r--  1 root users 68495 Jun 25 08:53 install.log

chgrp testing install.log
# chgrp: invalid group name `testing' <== 发生错误讯息啰～找不到这个群组名～
```

#### `chown` 改变文件拥有者

```shell
chown [-R] 账号名称 文件或目录
chown [-R] 账号名称:组名 文件或目录
```

选项与参数：

- `-R` 进行递归(recursive)的持续变更，亦即连同次目录下的所有文件都变更。

#### `chmod` 改变文件的权限

数字类型改变文件权限

- r : 4
- w : 2
- x : 1

```shell
chmod [-R] xyz 文件或目录
```

选项与参数：

- `xyz` 就是刚刚提到的数字类型的权限属性，为 rwx 属性数值的相加；
- `-R` 进行递归(recursive)的持续变更，亦即连同次目录下的所有文件都会变更。

符号类型改变文件权限

```shell
chmod   u/g/o/a   +(加入)/-(除去)/=(设定)   r/w/x   文件或目录
```

## linux 目录配置

### linux 目录配置的依据 FHS

|                           | 可分享的(shareable)          | 不可分享的(unshareable) |
| :------------------------ | :-------------------------- | :---------------------- |
|   不变的(static)      | `/usr` (软件放置处)           | `/etc` (配置文件)       |
|                      | `/opt` (第三方协力软件)        | `/boot` (开机与核心档)       |
|   可变动的(variable)  | `/var/mail` (使用者邮件信箱)      | `/var/run` (程序相关)   |
|                      | `/var/spool/news` (新闻组)    | `/var/lock` (程序相关)       |

#### 根目录 `/` 的意义与内容

| 目录     | 放置文件内容 |
| :------- | :--------- |
| `/bin`   | 系统放置执行文件的目录|
| `/boot`  | 放置开机会使用到的文件|
| `/dev`   | 任何装置与接口设备都是以文件的形式存放在这个目录|
| `/etc`   | 系统主要的配置文件|
| `/home`  | 系统默认的用户家目录|
| `/lib`   | `/lib` 放置的则是在开机时会用到的函数库,`/lib/modules/` 存放置核心相关的模块(驱动程序)|
| `/media` | 放置的是可移除的装置|
| `/mnt`   | 用于暂时挂载某些额外的装置，以前与 `/media` 作用相同，目前有了 `/media` 目录，仅用于暂时挂载|
| `/opt`   | 给第三方协力软件放置的目录|
| `/root`  | 系统管理员(root)的家目录|
| `/sbin`  | 放在`/sbin`底下的为开机过程中所需要的，里面包括了开机、修复、还原系统所需要的指令。 至于某些服务器软件程序，一般则放置到`/usr/sbin/`当中。至于本机自行安装的软件所产生的系统执行文件(system binary)， 则放置到`/usr/local/sbin/`当中了。常见的指令包括：`fdisk`, `fsck`, `ifconfig`, `init`, `mkfs` 等等。 |
| `/srv`   | 些网络服务启动之后，这些服务所需要取用的数据目录   |
| `/tmp`   | 让一般使用者或者是正在执行的程序暂时放置文件的地方 |

#### `/usr` 的意义与内容

| 目录            | 放置文件内容                                                               |
| :-------------- | :------------------------------------------------------------------------- |
| `/usr/X11R6/`   | 为 X Window System 重要数据所放置的目录，X11R6 为 X 第 11 版第六次释出     |
| `/usr/bin/`     | 绝大部分的用户可使用指令都放在这里                                         |
| `/usr/include/` | 放置 c/c++头文件                                                           |
| `/usr/lib/`     | 放置函数库、目标文件(object file)                                          |
| `/usr/local/`   | 系统管理员在本机自行安装自己下载的软件(非 distribution 默认提供者)         |
| `/usr/sbin/`    | 非系统正常运作所需要的系统指令                                             |
| `/usr/share/`   | 放置共享文件的地方，在这个目录下放置的数据几乎是不分硬件架构均可读取的数据 |
| `/usr/src/`     | 一般原始码建议放置到这里                                                   |

#### `/var` 的意义与内容

| 目录          | 放置文件内容                                                                         |
| :------------ | :----------------------------------------------------------------------------------- |
| `/var/cache/` | 程序运行中的缓存文件                                                                 |
| `/var/lib/`   | 程序本身执行的过程中，需要使用到的数据文件放置的目录                                 |
| `/var/lock/`  | 某些装置或者是文件资源一次只能被一个应用程序所使用，依次加锁(lock)确保为单一软件使用 |
| `/var/log/`   | 日志文件                                                                             |
| `/var/mail/`  | 放置个人邮件信箱的目录                                                               |
| `/var/run/`   | 某些程序或者是服务启动后，会将他们的 PID 放置在这个目录下                            |
| `/var/spool/` | 这个目录通常放置一些队列数据                                                         |

- `/etc` 配置文件
- `/bin` 重要执行档
- `/dev` 所需要的装置文件
- `/lib` 执行档所需的函式库与核心所需的模块
- `/sbin` 重要的系统执行文件

#### 目录树

![image](resources/directory_tree.gif)
